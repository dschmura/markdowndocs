<%# locals: (rendered_content:, related_docs:, current_mode:, available_modes:, toc_items:) %>
<aside class="sidebar space-y-6">
  <% if available_modes.length > 1 %>
    <%= render "markdowndocs/docs/mode_switcher",
      current_mode: current_mode,
      available_modes: available_modes %>
  <% end %>

  <% if toc_items.length >= 3 %>
    <div class="bg-white rounded-lg shadow-sm p-6">
      <nav aria-label="Table of Contents">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">On this page</h2>
        <ul class="space-y-2">
          <% toc_items.each do |item| %>
            <li class="<%= 'ml-4' if item[:level] == 3 %>">
              <a href="#<%= item[:slug] %>" class="text-sm text-gray-600 hover:text-indigo-600 transition-colors block py-1">
                <%= item[:text] %>
              </a>
            </li>
          <% end %>
        </ul>
      </nav>
    </div>
  <% end %>

  <% if related_docs.any? %>
    <div class="bg-white rounded-lg shadow-sm p-6 related-docs">
      <h2 class="text-lg font-semibold text-gray-900 mb-4">Related Documentation</h2>
      <ul class="space-y-3">
        <% related_docs.each do |related_doc| %>
          <li>
            <%= link_to related_doc.title, markdowndocs.doc_path(related_doc.slug), class: "text-sm text-indigo-600 hover:text-indigo-700 font-medium transition-colors" %>
            <p class="text-xs text-gray-600 mt-1"><%= related_doc.description %></p>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>
</aside>
